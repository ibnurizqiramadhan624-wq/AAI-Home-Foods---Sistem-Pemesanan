<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Orders - AAI Home Foods Admin</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Additional styles for orders page */
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }

        .status-pending {
            background: rgba(243, 156, 18, 0.1);
            color: #f39c12;
            border: 1px solid rgba(243, 156, 18, 0.2);
        }

        .status-processing {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.2);
        }

        .status-completed {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
            border: 1px solid rgba(39, 174, 96, 0.2);
        }

        .status-cancelled {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.2);
        }

        .customer-info {
            display: flex;
            flex-direction: column;
        }

        .customer-info small {
            color: #7f8c8d;
            font-size: 0.85rem;
        }

        .order-items {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            max-width: 250px;
        }

        .item-badge {
            background: #f8f9fa;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            color: #495057;
            border: 1px solid #dee2e6;
        }

        .price {
            font-weight: 600;
            color: #27ae60;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-view, .btn-edit {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .btn-view {
            background: #3498db;
            color: white;
        }

        .btn-view:hover {
            background: #2980b9;
        }

        .btn-edit {
            background: #f39c12;
            color: white;
        }

        .btn-edit:hover {
            background: #d68910;
        }

        .no-orders {
            text-align: center;
            padding: 40px 20px;
            color: #7f8c8d;
        }

        .no-orders i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #bdc3c7;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .modal-lg {
            max-width: 800px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .modal-header h3 {
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #7f8c8d;
        }

        .close-modal:hover {
            color: #e74c3c;
        }

        .modal-body {
            max-height: 60vh;
            overflow-y: auto;
            padding: 10px 0;
        }

        .modal-footer {
            padding-top: 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>

<body>
    <!-- Authentication & Authorization Check -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check if admin is logged in
            const adminToken = localStorage.getItem('admin_token');
            const adminRole = localStorage.getItem('admin_role');
            
            if (!adminToken) {
                alert('Anda harus login sebagai admin terlebih dahulu!');
                window.location.href = 'admin-login.html';
                return;
            }
            
            // Check if user has access to this page
            const allowedRoles = ['super_admin', 'order_manager'];
            if (!allowedRoles.includes(adminRole)) {
                alert('Akses ditolak! Halaman ini hanya untuk Admin dan Order Manager.');
                window.location.href = 'dashboard.html';
                return;
            }
        });
    </script>

    <header class="admin-header">
        <div class="container">
            <div class="navbar">
                <div class="nav-left">
                    <a href="../index.html" class="logo">AAI Home Foods</a>
                    <span class="admin-badge">Admin Panel</span>
                </div>
                
                <div class="nav-right">
                    <div class="admin-user">
                        <div class="user-icon">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <span id="header-admin-name">Administrator</span>
                    </div>
                    <ul class="nav-links">
                        <li><a href="../index.html" target="_blank" title="View Site">
                            <i class="fas fa-external-link-alt"></i> View Site
                        </a></li>
                        <li><a href="dashboard.html" title="Dashboard">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                        </a></li>
                        <li><a href="#" id="admin-logout" title="Logout">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <div class="admin-wrapper">
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <div class="admin-profile">
                    <div class="admin-icon">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <div class="admin-info">
                        <h3 id="admin-display-name">Admin User</h3>
                        <p id="admin-role-text">Administrator</p>
                        <span class="admin-status active">● Online</span>
                    </div>
                </div>
            </div>

            <nav class="sidebar-nav">
                <ul>
                    <li class="nav-item">
                        <a href="dashboard.html" id="nav-dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    
                    <li class="nav-item" id="nav-orders">
                        <a href="manage-orders.html">
                            <i class="fas fa-shopping-cart"></i>
                            <span>Manage Orders</span>
                            <span class="badge pending" id="pending-orders-badge">0</span>
                        </a>
                    </li>
                    
                    <li class="nav-item" id="nav-menu">
                        <a href="manage-menu.html">
                            <i class="fas fa-utensils"></i>
                            <span>Manage Menu</span>
                        </a>
                    </li>
                    
                    <li class="nav-item" id="nav-customers">
                        <a href="#">
                            <i class="fas fa-users"></i>
                            <span>Customers</span>
                        </a>
                    </li>
                    
                    <li class="nav-item" id="nav-payments">
                        <a href="#">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>Payments</span>
                        </a>
                    </li>
                    
                    <li class="nav-item" id="nav-analytics">
                        <a href="#">
                            <i class="fas fa-chart-line"></i>
                            <span>Analytics</span>
                        </a>
                    </li>
                    
                    <li class="nav-item" id="nav-settings">
                        <a href="#">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <p class="version">v1.0.0</p>
                <p class="copyright">© 2024 AAI Home Foods</p>
            </div>
        </aside>

        <main class="admin-main">
            <div class="container-fluid">
                <div class="page-header">
                    <h1><i class="fas fa-shopping-cart"></i> Manage Orders</h1>
                    <p class="page-subtitle">Lihat dan kelola semua pesanan pelanggan</p>
                </div>

                <div class="filter-section">
                    <div class="filter-group">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="searchOrder" placeholder="Cari pesanan atau pelanggan...">
                        </div>
                        
                        <select id="filterStatus" class="filter-select">
                            <option value="all">Semua Status</option>
                            <option value="pending">Pending</option>
                            <option value="processing">Processing</option>
                            <option value="completed">Completed</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                        
                        <input type="date" id="filterDate" class="date-filter">
                    </div>
                    
                    <div class="filter-stats">
                        <span class="stat-badge total">Total: <span id="total-orders-count">0</span></span>
                        <span class="stat-badge pending">Pending: <span id="pending-orders-count">0</span></span>
                        <span class="stat-badge completed">Completed: <span id="completed-orders-count">0</span></span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Customer</th>
                                        <th>Items</th>
                                        <th>Total</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersList">
                                    <tr>
                                        <td colspan="7" class="text-center">
                                            <div class="loading-spinner"></div>
                                            <p>Loading orders...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="pagination" id="pagination">
                            <button id="prev-page" disabled><i class="fas fa-chevron-left"></i></button>
                            <span id="page-info">Page 1 of 1</span>
                            <button id="next-page" disabled><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ORDER DETAIL MODAL -->
    <div class="modal" id="orderModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3><i class="fas fa-file-invoice"></i> Order Details</h3>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="modal-body" id="orderDetails">
                <!-- Details will be filled by JavaScript -->
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn-secondary close-modal">Close</button>
                <div class="action-buttons">
                    <button id="markProcessing" class="btn-warning">
                        <i class="fas fa-cog"></i> Processing
                    </button>
                    <button id="markCompleted" class="btn-success">
                        <i class="fas fa-check"></i> Complete
                    </button>
                    <button id="markCancelled" class="btn-danger">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Main JavaScript untuk manage orders
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize
            initializeAdminInfo();
            setupEventListeners();
            loadOrders();
        });

        function initializeAdminInfo() {
            // Set admin info from localStorage
            const adminName = localStorage.getItem('admin_name') || 'Administrator';
            const adminRole = localStorage.getItem('admin_role') || 'admin';
            
            document.getElementById('header-admin-name').textContent = adminName;
            document.getElementById('admin-display-name').textContent = adminName;
            
            // Set role text
            const roleText = document.getElementById('admin-role-text');
            switch(adminRole) {
                case 'super_admin':
                    roleText.textContent = 'Super Administrator';
                    roleText.style.color = '#8e44ad';
                    break;
                case 'order_manager':
                    roleText.textContent = 'Order Manager';
                    roleText.style.color = '#3498db';
                    break;
                case 'menu_manager':
                    roleText.textContent = 'Menu Manager';
                    roleText.style.color = '#e67e22';
                    break;
                default:
                    roleText.textContent = 'Administrator';
            }
            
            // Setup role-based menu
            setupRoleBasedMenu(adminRole);
            
            // Set current date as default filter
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('filterDate').value = today;
        }

        function setupRoleBasedMenu(role) {
            const menuPermissions = {
                'super_admin': ['dashboard', 'orders', 'menu', 'customers', 'payments', 'analytics', 'settings'],
                'order_manager': ['dashboard', 'orders', 'payments', 'analytics'],
                'menu_manager': ['dashboard', 'menu', 'analytics']
            };
            
            const allowedMenus = menuPermissions[role] || ['dashboard'];
            
            // Hide all menu items first
            document.querySelectorAll('.nav-item').forEach(item => {
                if (!item.id.includes('dashboard')) {
                    item.style.display = 'none';
                }
            });
            
            // Show only allowed menus
            allowedMenus.forEach(menuId => {
                const menuItem = document.getElementById(`nav-${menuId}`);
                if (menuItem) {
                    menuItem.style.display = 'block';
                }
            });
            
            // Highlight current page
            document.querySelectorAll('.nav-item a').forEach(link => {
                link.classList.remove('active');
            });
            
            const currentLink = document.querySelector('#nav-orders a');
            if (currentLink) {
                currentLink.classList.add('active');
            }
        }

        function setupEventListeners() {
            // Logout functionality
            document.getElementById('admin-logout').addEventListener('click', function(e) {
                e.preventDefault();
                if (confirm('Are you sure you want to logout?')) {
                    localStorage.clear();
                    window.location.href = 'admin-login.html';
                }
            });

            // Search functionality
            document.getElementById('searchOrder').addEventListener('input', filterOrders);
            
            // Status filter
            document.getElementById('filterStatus').addEventListener('change', filterOrders);
            
            // Date filter
            document.getElementById('filterDate').addEventListener('change', filterOrders);
            
            // Modal close buttons
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.getElementById('orderModal').style.display = 'none';
                });
            });
            
            // Action buttons in modal
            document.getElementById('markProcessing').addEventListener('click', () => {
                updateOrderStatus('processing');
            });
            
            document.getElementById('markCompleted').addEventListener('click', () => {
                updateOrderStatus('completed');
            });
            
            document.getElementById('markCancelled').addEventListener('click', () => {
                updateOrderStatus('cancelled');
            });
            
            // Close modal on outside click
            document.getElementById('orderModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.style.display = 'none';
                }
            });
        }

        // Global variables
        let allOrders = [];
        let currentOrderId = null;

        function loadOrders() {
            // Load orders from localStorage (simulated database)
            try {
                const orders = JSON.parse(localStorage.getItem('orders')) || [];
                allOrders = orders;
                displayOrders(orders);
                updateOrderStats(orders);
            } catch (error) {
                console.error('Error loading orders:', error);
                showNotification('Gagal memuat data pesanan', 'error');
            }
        }

        function displayOrders(orders) {
            const tbody = document.getElementById('ordersList');
            
            if (orders.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center">
                            <div class="no-orders">
                                <i class="fas fa-shopping-cart"></i>
                                <p>Belum ada pesanan</p>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = orders.map(order => {
                // Format order items
                const itemsHTML = order.items ? order.items.map(item => `
                    <span class="item-badge">${item.name} (${item.quantity}x)</span>
                `).join('') : '';
                
                // Format date
                const orderDate = order.order_date || order.createdAt || new Date().toISOString();
                const formattedDate = new Date(orderDate).toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                // Get status text
                const statusText = getStatusText(order.status);
                const statusClass = order.status || 'pending';
                
                return `
                    <tr data-order-id="${order.id || order.order_id}">
                        <td><strong>${order.id || order.order_id || 'N/A'}</strong></td>
                        <td>
                            <div class="customer-info">
                                <strong>${order.user_name || order.customer?.name || 'Pelanggan'}</strong>
                                <small>${order.user_email || order.customer?.email || ''}</small>
                                <small>${order.customer?.phone || ''}</small>
                            </div>
                        </td>
                        <td>
                            <div class="order-items">
                                ${itemsHTML}
                            </div>
                        </td>
                        <td class="price">Rp ${(order.total || 0).toLocaleString()}</td>
                        <td>${formattedDate}</td>
                        <td>
                            <span class="status-badge status-${statusClass}">
                                ${statusText}
                            </span>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-view" onclick="viewOrderDetails('${order.id || order.order_id}')">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn-edit" onclick="editOrderStatus('${order.id || order.order_id}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function getStatusText(status) {
            const statusMap = {
                'pending': 'Menunggu',
                'processing': 'Diproses',
                'completed': 'Selesai',
                'cancelled': 'Dibatalkan',
                'confirmed': 'Dikonfirmasi'
            };
            return statusMap[status] || status || 'Menunggu';
        }

        function updateOrderStats(orders) {
            const total = orders.length;
            const pending = orders.filter(o => o.status === 'pending').length;
            const completed = orders.filter(o => o.status === 'completed').length;
            
            document.getElementById('total-orders-count').textContent = total;
            document.getElementById('pending-orders-count').textContent = pending;
            document.getElementById('completed-orders-count').textContent = completed;
            document.getElementById('pending-orders-badge').textContent = pending;
        }

        function filterOrders() {
            const searchTerm = document.getElementById('searchOrder').value.toLowerCase();
            const statusFilter = document.getElementById('filterStatus').value;
            const dateFilter = document.getElementById('filterDate').value;
            
            let filtered = allOrders;
            
            // Apply search filter
            if (searchTerm) {
                filtered = filtered.filter(order => 
                    (order.user_name && order.user_name.toLowerCase().includes(searchTerm)) ||
                    (order.customer?.name && order.customer.name.toLowerCase().includes(searchTerm)) ||
                    (order.id && order.id.toLowerCase().includes(searchTerm)) ||
                    (order.order_id && order.order_id.toLowerCase().includes(searchTerm)) ||
                    (order.items && order.items.some(item => 
                        item.name && item.name.toLowerCase().includes(searchTerm)
                    ))
                );
            }
            
            // Apply status filter
            if (statusFilter !== 'all') {
                filtered = filtered.filter(order => order.status === statusFilter);
            }
            
            // Apply date filter
            if (dateFilter) {
                filtered = filtered.filter(order => {
                    const orderDate = order.order_date || order.createdAt;
                    if (!orderDate) return false;
                    
                    const orderDateOnly = new Date(orderDate).toISOString().split('T')[0];
                    return orderDateOnly === dateFilter;
                });
            }
            
            displayOrders(filtered);
        }

        // View order details
        window.viewOrderDetails = function(orderId) {
            const order = allOrders.find(o => o.id === orderId || o.order_id === orderId);
            if (!order) {
                showNotification('Pesanan tidak ditemukan', 'error');
                return;
            }
            
            currentOrderId = orderId;
            
            // Format items for display
            const itemsHTML = order.items ? order.items.map(item => `
                <div class="order-item-detail">
                    <div class="item-name">${item.name}</div>
                    <div class="item-qty">${item.quantity}x</div>
                    <div class="item-price">Rp ${item.price.toLocaleString()}</div>
                    <div class="item-total">Rp ${(item.price * item.quantity).toLocaleString()}</div>
                </div>
            `).join('') : '<p>Tidak ada item</p>';
            
            // Format customer info
            const customerInfo = order.customer || {};
            
            // Format dates
            const orderDate = new Date(order.order_date || order.createdAt).toLocaleDateString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Build modal content
            const modalContent = `
                <div class="order-details-container">
                    <div class="order-header">
                        <div class="order-id">
                            <h4>Order ID: ${order.id || order.order_id}</h4>
                            <span class="status-badge status-${order.status}">${getStatusText(order.status)}</span>
                        </div>
                        <div class="order-date">
                            <i class="far fa-calendar"></i> ${orderDate}
                        </div>
                    </div>
                    
                    <div class="customer-info-section">
                        <h4><i class="fas fa-user"></i> Informasi Pelanggan</h4>
                        <div class="customer-details">
                            <p><strong>Nama:</strong> ${customerInfo.name || order.user_name || 'N/A'}</p>
                            <p><strong>Email:</strong> ${customerInfo.email || order.user_email || 'N/A'}</p>
                            <p><strong>Telepon:</strong> ${customerInfo.phone || 'N/A'}</p>
                            <p><strong>Alamat:</strong> ${order.delivery?.address || 'N/A'}</p>
                        </div>
                    </div>
                    
                    <div class="order-items-section">
                        <h4><i class="fas fa-utensils"></i> Items Pesanan</h4>
                        <div class="items-list">
                            ${itemsHTML}
                        </div>
                    </div>
                    
                    <div class="order-summary">
                        <h4><i class="fas fa-receipt"></i> Ringkasan Pembayaran</h4>
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span>Rp ${(order.subtotal || order.total || 0).toLocaleString()}</span>
                        </div>
                        <div class="summary-row">
                            <span>Biaya Pengiriman:</span>
                            <span>Rp ${(order.deliveryCost || 10000).toLocaleString()}</span>
                        </div>
                        <div class="summary-row">
                            <span>Biaya Layanan:</span>
                            <span>Rp ${(order.serviceCost || 2000).toLocaleString()}</span>
                        </div>
                        <div class="summary-row total">
                            <span><strong>Total:</strong></span>
                            <span><strong>Rp ${(order.total || 0).toLocaleString()}</strong></span>
                        </div>
                    </div>
                    
                    <div class="payment-info">
                        <h4><i class="fas fa-credit-card"></i> Informasi Pembayaran</h4>
                        <p><strong>Metode:</strong> ${order.payment?.method || 'Cash on Delivery'}</p>
                        <p><strong>Status:</strong> ${order.payment?.status || 'Pending'}</p>
                    </div>
                </div>
            `;
            
            document.getElementById('orderDetails').innerHTML = modalContent;
            document.getElementById('orderModal').style.display = 'block';
        };

        // Edit order status
        window.editOrderStatus = function(orderId) {
            const order = allOrders.find(o => o.id === orderId || o.order_id === orderId);
            if (!order) return;
            
            currentOrderId = orderId;
            viewOrderDetails(orderId);
        };

        // Update order status
        function updateOrderStatus(newStatus) {
            if (!currentOrderId) return;
            
            const orders = JSON.parse(localStorage.getItem('orders')) || [];
            const orderIndex = orders.findIndex(o => o.id === currentOrderId || o.order_id === currentOrderId);
            
            if (orderIndex !== -1) {
                orders[orderIndex].status = newStatus;
                orders[orderIndex].updated_at = new Date().toISOString();
                
                if (newStatus === 'completed') {
                    orders[orderIndex].completed_at = new Date().toISOString();
                }
                
                localStorage.setItem('orders', JSON.stringify(orders));
                
                // Reload orders
                loadOrders();
                
                // Close modal
                document.getElementById('orderModal').style.display = 'none';
                
                // Show notification
                showNotification(`Status pesanan diubah menjadi ${getStatusText(newStatus)}`, 'success');
            }
        }

        function showNotification(message, type = 'success') {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                <span>${message}</span>
            `;

            document.body.appendChild(notification);

            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('fade-out');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Add CSS for notifications if not exists
        if (!document.querySelector('#notification-styles')) {
            const style = document.createElement('style');
            style.id = 'notification-styles';
            style.textContent = `
                .notification {
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 20px;
                    border-radius: 8px;
                    color: white;
                    font-weight: 500;
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    animation: slideIn 0.3s ease;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    max-width: 400px;
                }
                
                .notification.success {
                    background: #27ae60;
                    border-left: 4px solid #2ecc71;
                }
                
                .notification.error {
                    background: #e74c3c;
                    border-left: 4px solid #c0392b;
                }
                
                .notification.info {
                    background: #3498db;
                    border-left: 4px solid #2980b9;
                }
                
                .notification.fade-out {
                    animation: slideOut 0.3s ease forwards;
                }
                
                @keyframes slideIn {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                
                @keyframes slideOut {
                    from {
                        transform: translateX(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                }
                
                /* Order details styles */
                .order-details-container {
                    display: flex;
                    flex-direction: column;
                    gap: 20px;
                }
                
                .order-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding-bottom: 15px;
                    border-bottom: 2px solid #f1f2f6;
                }
                
                .order-id {
                    display: flex;
                    align-items: center;
                    gap: 15px;
                }
                
                .order-date {
                    color: #7f8c8d;
                    font-size: 0.9rem;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }
                
                .customer-info-section, .order-items-section, .order-summary, .payment-info {
                    background: #f8f9fa;
                    padding: 15px;
                    border-radius: 8px;
                }
                
                .customer-info-section h4, .order-items-section h4, .order-summary h4, .payment-info h4 {
                    margin-top: 0;
                    margin-bottom: 15px;
                    color: #2c3e50;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }
                
                .customer-details p {
                    margin: 8px 0;
                }
                
                .items-list {
                    display: flex;
                    flex-direction: column;
                    gap: 10px;
                }
                
                .order-item-detail {
                    display: grid;
                    grid-template-columns: 2fr 1fr 1fr 1fr;
                    gap: 15px;
                    padding: 10px;
                    background: white;
                    border-radius: 6px;
                    border: 1px solid #eee;
                }
                
                .summary-row {
                    display: flex;
                    justify-content: space-between;
                    padding: 8px 0;
                    border-bottom: 1px solid #eee;
                }
                
                .summary-row.total {
                    border-top: 2px solid #ddd;
                    border-bottom: none;
                    padding-top: 12px;
                    margin-top: 8px;
                    font-size: 1.1rem;
                }
                
                .payment-info p {
                    margin: 8px 0;
                }
            `;
            document.head.appendChild(style);
        }
    </script>
</body>
</html>